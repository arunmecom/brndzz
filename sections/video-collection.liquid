<!-- Add the slick-theme.css if you want default styling -->
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css" />
<!-- Add the slick-theme.css if you want default styling -->
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css" />





<div class="page-width">
    <div class="video-collection">
        <div class="left-block">
            <div class="youtube-block">
            <div id="ytplayer"></div>
                {% comment %} <iframe id="player" width="640" height="360"
                    src="https://www.youtube.com/embed/M7lc1UVf-VE?enablejsapi=1" frameborder="0"></iframe> {% endcomment %}
            </div>

            <div class="slider-caption-wrapper">
                <div class="slider-caption">current product shown</div>
            </div>

            <div class="img-thumb">
                <div class="slider-thumb">
                    {% for product in collection.products limit: product_limit %}
                    <div class="my-gutter" data-id="{{ product.handle}}">
                        <img
                            src="{{product.featured_media | img_url: '500x'}}">
                    </div>
                    {% endfor %}
                    {% comment %} <div class="my-gutter"><img
                            src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/twirling-hair-and-batting-eyes.jpg?v=1604055850">
                    </div>
                    <div class="my-gutter"><img
                            src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/woman-portrait-on-pink-brick.jpg?v=1604055850">
                    </div>
                    <div class="my-gutter"><img
                            src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/woman-blue-wall-portrait.jpg?v=1604055849">
                    </div>
                    <div class="my-gutter"><img
                            src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/lady-in-leather-jacket-in-the-city.jpg?v=1604055849">
                    </div>
                    <div class="my-gutter"><img
                            src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/fashion-model-in-fur.jpg?v=1604055850">
                    </div>
                    <div class="my-gutter"><img
                            src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/model-in-gold-fashion.jpg?v=1604055849">
                    </div> {% endcomment %}
                </div>
            </div>
        </div>
         {% for product in collection.products limit: 1 %}
        <div class="right-block">
            <div class="img-slider">
            
                <div class="img-column-1">
                    <img
                        src="{{product.featured_media | img_url: '500x'}}">
                </div>
           
                <div class="img-column-2">
                    <img
                        src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/twirling-hair-and-batting-eyes.jpg?v=1604055850">
                    <img
                        src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/woman-portrait-on-pink-brick.jpg?v=1604055850">
                    <img
                        src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/woman-blue-wall-portrait.jpg?v=1604055849">
                    <img
                        src="https://cdn.shopify.com/s/files/1/0500/4102/8774/files/fashion-model-in-fur.jpg?v=1604055850">
                </div>
            </div>

            <div class="prod-description">
                <h3 class="pd-h3">{{product.title}}</h3>
                <h6 class="pd-h6">description</h6>
                <div class="pd-text" id="pd-text">
                {{product.description}}
                </div>
            </div>

            <div class="shop-btn-wrapper">
                <div class="btn-wrapper">
                    <button  name="add" class="btn hero__btn btn-block" 
                        aria-label="add to bag" id="custom-addToCart" data-id="">ADD TO BAG</button>
                </div>

                <div class="btn-wrapper">
                    <a href="#" class="btn hero__btn btn-block btn-grey" aria-label="add to wish list">ADD TO WISH
                        LIST</a>
                </div>
            </div>

        </div>
          {% endfor %}
    </div>
</div>



<script>
var productsOfSameType = [];
{% assign col_handle = product.type | handle %}
{% for p in collection.products %}

  productsOfSameType.push( {{ p | json }} );
{% endfor %}
function fetchProduct(index){
    $('.img-column-1 img').attr('src', productsOfSameType[index].images[0])
    console.log(productsOfSameType[index])
    $('.pd-text').html(productsOfSameType[index].description);
    $('.pd-h3').html(productsOfSameType[index].title);
    
    $('#custom-addToCart').attr('data-id', productsOfSameType[index].variants[0].id)

}
</script>

<script>
 var tag = document.createElement('script');
  tag.src = "https://www.youtube.com/player_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  var player;
  function onYouTubePlayerAPIReady() {
    player = new YT.Player('ytplayer', {
      height: '360',
      width: '640',
      videoId: 'Gv_XBMrPvRw'
    });
  }
  function updateProd() {
      var videoTime = player.playerInfo.currentTime;
      if(videoTime>0 && videoTime <60){
         fetchProduct(1)
         return;
      }
      if(videoTime>60 && videoTime <120){
         fetchProduct(2)
         return;
      }
      if(videoTime>120 && videoTime <180){
         fetchProduct(3)
         return;
      }
      if(videoTime>180 && videoTime <240){
         fetchProduct(4)
         return;
      }
      if(videoTime>240 && videoTime <300){
         fetchProduct(5)
         return;
      }
  }
 setInterval(function () {
        //console.log(player.playerInfo.currentTime);
        updateProd()
    },1000);
    
</script>




<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

<script>
    $('.slider-thumb').slick({
        infinite: true,
        slidesToShow: 5,
        slidesToScroll: 1,
        arrows: true,
        focusOnSelect: true,
         responsive: [
    {
      breakpoint: 1024,
      settings: {
        slidesToShow: 3,
        slidesToScroll: 1,
      }
    },
    {
      breakpoint: 600,
      settings: {
        slidesToShow: 2,
        slidesToScroll: 2
      }
    },
    {
      breakpoint: 480,
      settings: {
        slidesToShow: 1,
        slidesToScroll: 1
      }
    }
    // You can unslick at a given breakpoint now by adding:
    // settings: "unslick"
    // instead of a settings object
    ]
    });
    $('.slider-thumb').on('beforeChange', function (event, slick, currentSlide, nextSlide) {
        console.log(nextSlide);
        fetchProduct(nextSlide)
    });
</script>


<script>
$('#custom-addToCart').on('click', function(){
    var variant_id = $(this).attr('data-id');
     data = {
      "id": variant_id,
      "quantity": 1
    }
     $.ajax({
      type: 'POST', 
      url: '/cart/add.js',
      dataType: 'json', 
      data: data,
      success: addToCartOk,
      error: addToCartFail
    });


})
function addToCartOk() {
    console.log('prodcut added');
    location.href = '/cart'
}
function addToCartFail() {
    console.log(' cart is faild')
}
 

</script>